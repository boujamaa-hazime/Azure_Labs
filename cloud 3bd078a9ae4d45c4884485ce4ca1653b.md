# cloud

Created: August 3, 2023 9:42 PM
Type: cloud
Materials: https://github.com/MicrosoftLearning/AZ-104-MicrosoftAzureAdministrator/blob/master/Instructions/Labs/LAB_05-Implement_Intersite_Connectivity.md
Reviewed: No
Number: 5
Status: Done

![Untitled](cloud%203bd078a9ae4d45c4884485ce4ca1653b/Untitled.png)

### Step1: I create the lab environment for this :

I have two JSON files template and parameter 

```powershell
$location1 = 'eastus'

$location2 = 'westus'

$rgName = 'az104-05-rg1'

New-AzResourceGroup -Name $rgName -Location $location1
```

```powershell
New-AzResourceGroupDeployment    -ResourceGroupName $rgName
-TemplateFile $HOME/az104-05-vnetvm-loop-template.json    -TemplateParameterFile $HOME/az104-05-vnetvm-loop-parameters.json
-location1 $location1 `
-location2 $location2
```

These two code are used for I can create the resources i need .

to see all the resources I just create use this :

```powershell
get-AzResource -ResourceGroupName $rgName |Format-Table
```

![Untitled](cloud%203bd078a9ae4d45c4884485ce4ca1653b/Untitled%201.png)

all the steps are done on the portal for configuring peering can be done using this code 

```powershell
$rgName = 'az104-05-rg1'

$vnet0 = Get-AzVirtualNetwork -Name 'az104-05-vnet0' -ResourceGroupName $rgname

$vnet1 = Get-AzVirtualNetwork -Name 'az104-05-vnet1' -ResourceGroupName $rgname

Add-AzVirtualNetworkPeering -Name 'az104-05-vnet0_to_az104-05-vnet1' -VirtualNetwork $vnet0 -RemoteVirtualNetworkId $vnet1.Id

Add-AzVirtualNetworkPeering -Name 'az104-05-vnet1_to_az104-05-vnet0' -VirtualNetwork $vnet1 -RemoteVirtualNetworkId $vnet0.Id
```

we can use this following script to test the connectivity :

```powershell
Test-NetConnection -ComputerName 10.51.0.4 -Port 3389 -InformationLevel 'Detailed'
```

---

---

### clean up resources:

---

---

```powershell
Get-AzResourceGroup -Name 'az104-05*'
Get-AzResourceGroup -Name 'az104-05*' | Remove-AzResourceGroup -Force -AsJob
```